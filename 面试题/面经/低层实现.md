# IO 多路复用

- **底层实现**:
  - 通过操作系统提供的 select、poll、epoll 等机制实现。
  - 允许单个线程监视多个文件描述符，当某个文件描述符就绪时，通知应用程序进行处理。

### `select`

- **原理**：使用固定大小的位图监视文件描述符集合。
- **优点**：跨平台支持，兼容性好。
- **缺点**：文件描述符集合大小（1024个）固定，效率较低。

### `poll`

- **原理**：不限制大小的poll,使用动态数组监视文件描述符集合。
- **优点**：文件描述符集合大小不受限制，支持更多并发连接。
- **缺点**：效率仍然较低。

### `epoll`

- **原理**：使用事件驱动方式监视文件描述符，使用红黑树和链表管理。
- **优点**：只返回就绪的文件描述符，效率高，支持边缘触发和水平触发。
- **缺点**：仅支持 Linux 系统。

# DMA拷贝

DMA（Direct Memory Access，直接内存访问）是一种计算机技术，允许硬件设备（如硬盘、网卡等）直接与系统内存进行数据传输，而不需要CPU的干预。通过DMA技术，硬件设备可以直接读取或写入内存，从而显著提高数据传输的效率。

# 0拷贝

https://juejin.cn/post/6995519558475841550

# 进程和线程的区别

进程（Process）和线程（Thread）是操作系统中用于并发执行任务的两个基本概念，它们的主要区别如下：

#### 1. 定义

- **进程**：进程是操作系统进行资源分配和调度的基本单位。每个进程都有独立的地址空间、内存、数据栈等资源。
- **线程**：线程是进程中的一个执行单元，是操作系统进行调度的最小单位。一个进程可以包含多个线程，这些线程共享进程的资源。

#### 2. 资源分配

- **进程**：每个进程都有独立的地址空间和系统资源（如内存、文件描述符等），进程之间的资源是隔离的。
- **线程**：线程共享所属进程的地址空间和系统资源，但每个线程有自己的栈空间和局部变量。

#### 3. 通信方式

- **进程**：进程之间的通信需要通过操作系统提供的进程间通信（IPC）机制，如管道、消息队列、共享内存、信号量等。
- **线程**：线程之间的通信可以直接通过共享内存进行，因为它们共享同一个地址空间。

#### 4. 切换开销

- **进程**：进程切换涉及保存和恢复整个进程的上下文（包括寄存器、内存映射等），开销较大。
- **线程**：线程切换只涉及保存和恢复线程的上下文（主要是寄存器和栈），开销较小。

#### 5. 创建和销毁

- **进程**：创建和销毁进程的开销较大，因为需要分配和释放独立的资源。
- **线程**：创建和销毁线程的开销较小，因为线程共享进程的资源。

### 线程共享进程的资源

线程共享进程的以下资源：

1. **地址空间**：线程共享进程的地址空间，包括代码段、数据段、堆等。
2. **文件描述符**：线程共享进程打开的文件描述符，可以访问相同的文件和网络连接。
3. **信号处理器**：线程共享进程的信号处理器，可以处理相同的信号。
4. **用户ID和组ID**：线程共享进程的用户ID和组ID，具有相同的权限。
5. **环境变量**：线程共享进程的环境变量。
6. **资源限制**：线程共享进程的资源限制（如CPU时间、内存使用等）。

### 线程独有的资源

虽然线程共享进程的资源，但每个线程也有一些独有的资源：

1. **栈空间**：每个线程有自己的栈空间，用于存储局部变量和函数调用信息。
2. **寄存器状态**：每个线程有自己的寄存器状态，用于保存线程的执行上下文。
3. **线程ID**：每个线程有自己的唯一标识符（线程ID）。
4. **错误码**：每个线程有自己的错误码（errno）。

### 协程独有的资源

1. **栈（Stack）**：协程通常有自己的栈空间，但栈的大小通常比线程小得多，可以通过配置进行调整。
2. **寄存器（Registers）**：协程在执行时也需要使用CPU的寄存器。
3. **程序计数器（Program Counter）**：记录当前协程执行的指令地址。
4. **协程本地存储（Coroutine Local Storage）**：类似于线程本地存储，协程可以有自己的本地存储。